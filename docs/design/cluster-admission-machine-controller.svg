<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="950px" preserveAspectRatio="none" style="width:1093px;height:950px;" version="1.1" viewBox="0 0 1093 950" width="1093px" zoomAndPan="magnify"><defs><filter height="300%" id="fianikoe22lzt" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="507.5" cy="20" fill="#000000" filter="url(#fianikoe22lzt)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="445" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="105" x="455" y="71.6016">Machine controller</text><rect fill="#FEFECE" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="261" x="377" y="148.1328"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="241" x="387" y="169.7344">Machine controller enqueues a Create call</text><rect fill="#FEFECE" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="239" x="388" y="202.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="219" x="398" y="223.8672">Get control plane machines for cluster</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="420,256.3984,595,256.3984,607,268.3984,595,280.3984,420,280.3984,408,268.3984,420,256.3984" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="175" x="420" y="272.5557">A control plane machine is ready</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="390" y="266.0781">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="607" y="266.0781">no</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="127,290.3984,291,290.3984,303,302.3984,291,314.3984,127,314.3984,115,302.3984,127,290.3984" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="164" x="127" y="306.5557">Machine has control plane role</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="97" y="300.0781">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="303" y="300.0781">no</text><rect fill="#ADD8E6" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="190" x="10" y="324.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="170" x="20" y="346">Join as control plane member</text><rect fill="#ADD8E6" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="245.5" y="324.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="255.5" y="346">Join as worker node</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="209,364.5313,221,376.5313,209,388.5313,197,376.5313,209,364.5313" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="724,290.3984,888,290.3984,900,302.3984,888,314.3984,724,314.3984,712,302.3984,724,290.3984" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="164" x="724" y="306.5557">Machine has control plane role</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="694" y="300.0781">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="900" y="300.0781">no</text><rect fill="#FEFECE" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="205" x="527.5" y="324.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="185" x="537.5" y="346">Create control plane config map</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="523.5,393.5313,736.5,393.5313,748.5,405.5313,736.5,417.5313,523.5,417.5313,511.5,405.5313,523.5,393.5313" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="523.5" y="409.6885">Control plane config map already exists</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="493.5" y="403.2109">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="748.5" y="403.2109">no</text><rect fill="#FFC0CB" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="430.5" y="427.5313"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="122" x="440.5" y="449.1328">Return RequeueError</text><rect fill="#ADD8E6" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="700.5" y="427.5313"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="710.5" y="449.1328">Init control plane</text><rect fill="#ADD8E6" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="245" x="636" y="481.6641"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="225" x="646" y="503.2656">Set ready status on Machine annotation</text><rect fill="#ADD8E6" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="211" x="653" y="535.7969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="191" x="663" y="557.3984">Patch Machine back to API server</text><rect fill="#ADD8E6" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="656.5" y="589.9297"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="184" x="666.5" y="611.5313">Delete control plane config map</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="630,630.0625,642,642.0625,630,654.0625,618,642.0625,630,630.0625" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FFC0CB" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="911" y="324.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="122" x="921" y="346">Return RequeueError</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="806,660.0625,818,672.0625,806,684.0625,794,672.0625,806,660.0625" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="507.5,690.0625,519.5,702.0625,507.5,714.0625,495.5,702.0625,507.5,690.0625" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="507.5,104.1328,519.5,116.1328,507.5,128.1328,495.5,116.1328,507.5,104.1328" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="426.5,734.0625,588.5,734.0625,600.5,746.0625,588.5,758.0625,426.5,758.0625,414.5,746.0625,426.5,734.0625" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="426.5" y="750.2197">Create returned RequeueError</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="600.5" y="743.7422">yes</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="449.5,799.3379,565.5,799.3379,577.5,811.3379,565.5,823.3379,449.5,823.3379,437.5,811.3379,449.5,799.3379" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="449.5" y="815.4951">Create returned error</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="419.5" y="809.0176">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="577.5" y="809.0176">no</text><rect fill="#FFC0CB" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="316.75" y="833.3379"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="131" x="326.75" y="854.9395">Error creating machine</text><rect fill="#ADD8E6" filter="url(#fianikoe22lzt)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="270" x="487.75" y="833.3379"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="250" x="497.75" y="854.9395">Machine has initialized or joined the cluster</text><polygon fill="#FEFECE" filter="url(#fianikoe22lzt)" points="507.5,873.4707,519.5,885.4707,507.5,897.4707,495.5,885.4707,507.5,873.4707" style="stroke: #A80036; stroke-width: 1.5;"/><ellipse cx="507.5" cy="928.4707" fill="#FFFFFF" filter="url(#fianikoe22lzt)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="507.5" cy="928.4707" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="30" y2="50"/><polygon fill="#A80036" points="503.5,40,507.5,50,511.5,40,507.5,44" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="182.2656" y2="202.2656"/><polygon fill="#A80036" points="503.5,192.2656,507.5,202.2656,511.5,192.2656,507.5,196.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="115" x2="105" y1="302.3984" y2="302.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="105" x2="105" y1="302.3984" y2="324.3984"/><polygon fill="#A80036" points="101,314.3984,105,324.3984,109,314.3984,105,318.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="303" x2="313" y1="302.3984" y2="302.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="313" x2="313" y1="302.3984" y2="324.3984"/><polygon fill="#A80036" points="309,314.3984,313,324.3984,317,314.3984,313,318.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="105" x2="105" y1="358.5313" y2="376.5313"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="105" x2="197" y1="376.5313" y2="376.5313"/><polygon fill="#A80036" points="187,372.5313,197,376.5313,187,380.5313,191,376.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="313" x2="313" y1="358.5313" y2="376.5313"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="313" x2="221" y1="376.5313" y2="376.5313"/><polygon fill="#A80036" points="231,372.5313,221,376.5313,231,380.5313,227,376.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="758.5" x2="758.5" y1="461.6641" y2="481.6641"/><polygon fill="#A80036" points="754.5,471.6641,758.5,481.6641,762.5,471.6641,758.5,475.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="758.5" x2="758.5" y1="515.7969" y2="535.7969"/><polygon fill="#A80036" points="754.5,525.7969,758.5,535.7969,762.5,525.7969,758.5,529.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="758.5" x2="758.5" y1="569.9297" y2="589.9297"/><polygon fill="#A80036" points="754.5,579.9297,758.5,589.9297,762.5,579.9297,758.5,583.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="511.5" x2="501.5" y1="405.5313" y2="405.5313"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="501.5" x2="501.5" y1="405.5313" y2="427.5313"/><polygon fill="#A80036" points="497.5,417.5313,501.5,427.5313,505.5,417.5313,501.5,421.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="748.5" x2="758.5" y1="405.5313" y2="405.5313"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="758.5" x2="758.5" y1="405.5313" y2="427.5313"/><polygon fill="#A80036" points="754.5,417.5313,758.5,427.5313,762.5,417.5313,758.5,421.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="501.5" x2="501.5" y1="461.6641" y2="642.0625"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="501.5" x2="618" y1="642.0625" y2="642.0625"/><polygon fill="#A80036" points="608,638.0625,618,642.0625,608,646.0625,612,642.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="758.5" x2="758.5" y1="624.0625" y2="642.0625"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="758.5" x2="642" y1="642.0625" y2="642.0625"/><polygon fill="#A80036" points="652,638.0625,642,642.0625,652,646.0625,648,642.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="630" x2="630" y1="358.5313" y2="393.5313"/><polygon fill="#A80036" points="626,383.5313,630,393.5313,634,383.5313,630,387.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="712" x2="630" y1="302.3984" y2="302.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="630" x2="630" y1="302.3984" y2="324.3984"/><polygon fill="#A80036" points="626,314.3984,630,324.3984,634,314.3984,630,318.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="900" x2="982" y1="302.3984" y2="302.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="982" x2="982" y1="302.3984" y2="324.3984"/><polygon fill="#A80036" points="978,314.3984,982,324.3984,986,314.3984,982,318.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="630" x2="630" y1="654.0625" y2="672.0625"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="630" x2="794" y1="672.0625" y2="672.0625"/><polygon fill="#A80036" points="784,668.0625,794,672.0625,784,676.0625,788,672.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="982" x2="982" y1="358.5313" y2="672.0625"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="982" x2="818" y1="672.0625" y2="672.0625"/><polygon fill="#A80036" points="828,668.0625,818,672.0625,828,676.0625,824,672.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="408" x2="209" y1="268.3984" y2="268.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="209" x2="209" y1="268.3984" y2="290.3984"/><polygon fill="#A80036" points="205,280.3984,209,290.3984,213,280.3984,209,284.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="607" x2="806" y1="268.3984" y2="268.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="806" x2="806" y1="268.3984" y2="290.3984"/><polygon fill="#A80036" points="802,280.3984,806,290.3984,810,280.3984,806,284.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="209" x2="209" y1="388.5313" y2="702.0625"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="209" x2="495.5" y1="702.0625" y2="702.0625"/><polygon fill="#A80036" points="485.5,698.0625,495.5,702.0625,485.5,706.0625,489.5,702.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="806" x2="806" y1="684.0625" y2="702.0625"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="806" x2="519.5" y1="702.0625" y2="702.0625"/><polygon fill="#A80036" points="529.5,698.0625,519.5,702.0625,529.5,706.0625,525.5,702.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="236.3984" y2="256.3984"/><polygon fill="#A80036" points="503.5,246.3984,507.5,256.3984,511.5,246.3984,507.5,250.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="128.1328" y2="148.1328"/><polygon fill="#A80036" points="503.5,138.1328,507.5,148.1328,511.5,138.1328,507.5,142.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="600.5" x2="1067" y1="746.0625" y2="746.0625"/><polygon fill="#A80036" points="1063,448.5977,1067,438.5977,1071,448.5977,1067,444.5977" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1067" x2="1067" y1="116.1328" y2="746.0625"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1067" x2="519.5" y1="116.1328" y2="116.1328"/><polygon fill="#A80036" points="529.5,112.1328,519.5,116.1328,529.5,120.1328,525.5,116.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="714.0625" y2="734.0625"/><polygon fill="#A80036" points="503.5,724.0625,507.5,734.0625,511.5,724.0625,507.5,728.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="84.1328" y2="104.1328"/><polygon fill="#A80036" points="503.5,94.1328,507.5,104.1328,511.5,94.1328,507.5,98.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="437.5" x2="392.25" y1="811.3379" y2="811.3379"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="392.25" x2="392.25" y1="811.3379" y2="833.3379"/><polygon fill="#A80036" points="388.25,823.3379,392.25,833.3379,396.25,823.3379,392.25,827.3379" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="577.5" x2="622.75" y1="811.3379" y2="811.3379"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="622.75" x2="622.75" y1="811.3379" y2="833.3379"/><polygon fill="#A80036" points="618.75,823.3379,622.75,833.3379,626.75,823.3379,622.75,827.3379" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="392.25" x2="392.25" y1="867.4707" y2="885.4707"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="392.25" x2="495.5" y1="885.4707" y2="885.4707"/><polygon fill="#A80036" points="485.5,881.4707,495.5,885.4707,485.5,889.4707,489.5,885.4707" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="622.75" x2="622.75" y1="867.4707" y2="885.4707"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="622.75" x2="519.5" y1="885.4707" y2="885.4707"/><polygon fill="#A80036" points="529.5,881.4707,519.5,885.4707,529.5,889.4707,525.5,885.4707" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="758.0625" y2="799.3379"/><polygon fill="#A80036" points="503.5,789.3379,507.5,799.3379,511.5,789.3379,507.5,793.3379" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="511.5" y="779.5176">no</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="507.5" x2="507.5" y1="897.4707" y2="917.4707"/><polygon fill="#A80036" points="503.5,907.4707,507.5,917.4707,511.5,907.4707,507.5,911.4707" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml cluster-admission-machine-controller

start;
:Machine controller;

repeat
  :Machine controller enqueues a Create call;
  :Get control plane machines for cluster;
  if (A control plane machine is ready) then (yes)
    if (Machine has control plane role) then (yes)
      #LightBlue:Join as control plane member;
    else (no)
      #LightBlue:Join as worker node;
    endif
  else (no)
    if (Machine has control plane role) then (yes)
      :Create control plane config map;
      if (Control plane config map already exists) then (yes)
        #Pink:Return RequeueError;
      else (no)
        #LightBlue:Init control plane;
        #LightBlue:Set ready status on Machine annotation;
        #LightBlue:Patch Machine back to API server;
        #LightBlue:Delete control plane config map;
      endif
    else (no)
      #Pink:Return RequeueError;
    endif
  endif
repeat while (Create returned RequeueError) is (yes)
-> no;
if (Create returned error) then (yes)
  #Pink:Error creating machine;
else (no)
  #LightBlue:Machine has initialized or joined the cluster;
endif
stop;

@enduml

PlantUML version 1.2019.06(Fri May 24 12:10:25 CDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Mac OS X
OS Version: 10.14.5
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>